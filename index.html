<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Lista de Tarefas</h1>    
    <div id="ilha-de-botoes">
        <input id="tarefa" type="text" placeholder="Insira aqui sua tarefa"></input>
        <input id= "seleciona-data" type="date" />
        <button onclick="adicionarTarefa()">Adicionar Tarefa</button>
        <div id="lista-de-tarefas"></div>
    </div>

    <script>
        //MVC -> Modelagem, Visualização, Controle
        //Seção de modelagem ()

        let afazeres;
        const afazeresSalvos = JSON.parse(localStorage.getItem("afazeres"));
        if (Array.isArray(afazeresSalvos)) {
            afazeres = JSON.parse(localStorage.getItem("afazeres"));
        } else {
            afazeres = JSON.parse(localStorage.getItem("afazeres"));
            afazeres = [
                {
                    nome: "Lavar louça",
                    data: "15-08-2025",
                    id: "id1"
                },
                {
                    nome: "Lavar banheiro",
                    data: "20-08-2025",
                    id: "id2"
                },
                {
                    nome: "Estender roupa",
                    data: "25-08-2025",
                    id: "id3"
                },
                {
                    nome: "Assistir o jogo do Corinthians",
                    data: "16-08-2025",
                    id: "id4"
                }
            ];
        };

        //Salva as tarefas no navegador
        const salvarTarefas = () => localStorage.setItem("afazeres", JSON.stringify(afazeres));
        salvarTarefas();

        //Seção de Visualização

        let renderizar = () => {
            document.getElementById("lista-de-tarefas").innerHTML = "";
            afazeres.forEach(
                (tarefa) => {
                    const elemento = document.createElement("div");
                    elemento.innerHTML = tarefa.nome + " " + tarefa.data;
                    elemento.className = "elemento"

                    const botaoApagar = document.createElement("button");
                    botaoApagar.innerHTML = "Apagar";
                    botaoApagar.style = "margin-left: 12px;"
                    botaoApagar.id = tarefa.id;
                    botaoApagar.onclick = apagarTarefa;
                    elemento.appendChild(botaoApagar);

                    const listaDeTarefas = document.getElementById("lista-de-tarefas");
                    listaDeTarefas.appendChild(elemento);
                }
            );
        }
        

        const adicionarTarefa = () => {
            const campoTarefa = document.getElementById("tarefa");
            const tarefa = campoTarefa.value;

            const campoData = document.getElementById("seleciona-data");
            const prazo = campoData.value;

            const cron = "" + new Date().getTime();

            afazeres.push(
                {
                    nome: tarefa,
                    data: prazo,
                    id: cron
                }
            )
            salvarTarefas();
            renderizar();
        };

        let apagarTarefa = (evento) => {
            const botaoApagar = evento.target;
            const idASerApagado = botaoApagar.id;
            afazeres = afazeres.filter((tarefa) => {
                if (tarefa.id === idASerApagado) {
                    return false;
                } else {
                    return true;
                }
            });
            salvarTarefas();
            renderizar();
        };

        renderizar();

    </script>
</body>

</html>